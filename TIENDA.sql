CREATE TABLE LABORATORIO_GENERO (
	TGE_ID INTEGER NOT NULL,
	TGE_DESCRIPCION VARCHAR2(40) NOT NULL,
    CONSTRAINT PK_TGE_ID PRIMARY KEY(TGE_ID)
);

CREATE TABLE LABORATORIO_PERSONA(
	PER_ID INTEGER NOT NULL,
	PER_TGE_ID INTEGER NOT NULL,
	PER_IDENTIFICACION VARCHAR2(15)NOT NULL,
	PER_PRIMER_APELLIDO VARCHAR2(35)NOT NULL,
	PER_SEGUNDO_APELLIDO VARCHAR2(35),
	PER_PRIMER_NOMBRE VARCHAR2(35)NOT NULL,
	PER_SEGUNDO_NOMBRE VARCHAR2(35),
	CONSTRAINT PK_PER_ID PRIMARY KEY(PER_ID),
    CONSTRAINT FK_PER_TGE FOREIGN KEY(PER_TGE_ID)REFERENCES LABORATORIO_GENERO(TGE_ID)
);

CREATE TABLE LABORATORIO_VENDEDOR(
	VND_ID INTEGER NOT NULL,
	VND_PER_ID INTEGER NOT NULL,
	VND_PORC_COMISION NUMBER(20,2) NOT NULL,
    CONSTRAINT PK_VND_ID PRIMARY KEY(VND_ID),
	CONSTRAINT FK_VND_PER FOREIGN KEY (VND_PER_ID) REFERENCES LABORATORIO_PERSONA(PER_ID)
);

CREATE TABLE LABORATORIO_CLIENTE(
	CTE_ID INTEGER NOT NULL,
	CTE_PER_ID INTEGER NOT NULL,
	CTE_LIMITE_CREDITO DECIMAL(20,2 )NOT NULL,
    CONSTRAINT PK_CTE_ID PRIMARY KEY(CTE_ID),
	CONSTRAINT FK_CTE_PER FOREIGN KEY (CTE_PER_ID) REFERENCES LABORATORIO_PERSONA(PER_ID)
);

CREATE TABLE LABORATORIO_COLOR(
	CLR_ID INTEGER NOT NULL,
	CLR_DESCRIPCION VARCHAR2(30)NOT NULL,
    CONSTRAINT PK_CLR_ID PRIMARY KEY(CLR_ID)
);

CREATE TABLE LABORATORIO_MARCA(
	MRC_ID INTEGER NOT NULL,
	MRC_DESCRIPCION VARCHAR2(30)NOT NULL,
    CONSTRAINT PK_MRC_ID PRIMARY KEY(MRC_ID)
);

CREATE TABLE LABORATORIO_TAMANO(
	TMN_ID INTEGER NOT NULL,
	TMN_DESCRIPCION VARCHAR2(30)NOT NULL,
    CONSTRAINT PK_TMN_ID PRIMARY KEY(TMN_ID)
);

CREATE TABLE LABORATORIO_TIPO_BICICLETA(
	TBC_ID INTEGER NOT NULL,
	TBC_DESCRIPCION VARCHAR2(30)NOT NULL,
    CONSTRAINT PK_TBC_ID PRIMARY KEY(TBC_ID)
);

CREATE TABLE LABORATORIO_INVENTARIO(
	INV_ID INTEGER NOT NULL,
	INV_TBC_ID INTEGER NOT NULL,
	INV_MRC_ID INTEGER NOT NULL,
	INV_CLR_ID INTEGER NOT NULL,
	INV_TMN_ID INTEGER NOT NULL,
	INV_NUMERO_SERIO INTEGER NOT NULL,
	INV_MODELO VARCHAR2(35) NOT NULL,
	INV_FECHA DATE NOT NULL,
	INV_PRECIO_VENTA DECIMAL(20,2) NOT NULL,
    CONSTRAINT PK_INV_ID PRIMARY KEY(INV_ID),

	CONSTRAINT FK_INV_TBC FOREIGN KEY (INV_TBC_ID) REFERENCES LABORATORIO_TIPO_BICICLETA(TBC_ID),
	CONSTRAINT FK_INV_MRC FOREIGN KEY (INV_MRC_ID) REFERENCES LABORATORIO_MARCA(MRC_ID),
	CONSTRAINT FK_INV_CLR FOREIGN KEY (INV_CLR_ID) REFERENCES LABORATORIO_COLOR(CLR_ID),
	CONSTRAINT FK_INV_TMN FOREIGN KEY (INV_TMN_ID) REFERENCES LABORATORIO_TAMANO(TMN_ID)
);

CREATE TABLE LABORATORIO_VENTA(
	VNT_ID INTEGER NOT NULL,
	VNT_VND_ID INTEGER NOT NULL,
	VNT_CTE_ID INTEGER NOT NULL,
	VNT_INV_ID INTEGER NOT NULL,
	VNT_FECHA DATE NOT NULL,
	VNT_PRECIO_COSTO DECIMAL(20,2) NOT NULL,
	VNT_DESCUENTO DECIMAL(20,2) NOT NULL,
    CONSTRAINT PK_VNT_ID PRIMARY KEY(VNT_ID),

	CONSTRAINT FK_VNT_VND FOREIGN KEY (VNT_VND_ID) REFERENCES LABORATORIO_VENDEDOR(VND_ID),
	CONSTRAINT FK_VNT_CTE FOREIGN KEY (VNT_CTE_ID) REFERENCES LABORATORIO_CLIENTE(CTE_ID),
	CONSTRAINT FK_VNT_INV FOREIGN KEY (VNT_INV_ID) REFERENCES LABORATORIO_INVENTARIO(INV_ID)
);

SELECT * 
    FROM LABORATORIO_GENERO;

SELECT *
    FROM LABORATORIO_PERSONA;
    
INSERT INTO LABORATORIO_GENERO(TGE_ID, TGE_DESCRIPCION) VALUES (1, 'Femenino');

INSERT INTO LABORATORIO_GENERO(TGE_ID, TGE_DESCRIPCION) VALUES (2, 'Masculino');

INSERT INTO LABORATORIO_GENERO(TGE_ID, TGE_DESCRIPCION) VALUES (3, 'No indicado');

INSERT INTO LABORATORIO_PERSONA(PER_ID,
PER_TGE_ID,
PER_IDENTIFICACION,
PER_PRIMER_APELLIDO,
PER_SEGUNDO_APELLIDO,
PER_PRIMER_NOMBRE,
PER_SEGUNDO_NOMBRE) 
VALUES 
(1,
1,
'109990999',
'Salazar',
'Artavia',
'Calos',
'Alberto'
);

INSERT INTO LABORATORIO_PERSONA(PER_ID,
PER_TGE_ID,
PER_IDENTIFICACION,
PER_PRIMER_APELLIDO,
PER_SEGUNDO_APELLIDO,
PER_PRIMER_NOMBRE,
PER_SEGUNDO_NOMBRE) 
VALUES 
(2,
2,
'402620335',
'Hernandez',
'Ugalde',
'Erick',
'Andrey'
);

INSERT INTO LABORATORIO_PERSONA(PER_ID,
PER_TGE_ID,
PER_IDENTIFICACION,
PER_PRIMER_APELLIDO,
PER_SEGUNDO_APELLIDO,
PER_PRIMER_NOMBRE,
PER_SEGUNDO_NOMBRE) 
VALUES 
(3,
1,
'402580500',
'Jimenez',
'Montero',
'Krystel',
'Maria'
);

INSERT INTO LABORATORIO_PERSONA(PER_ID,
PER_TGE_ID,
PER_IDENTIFICACION,
PER_PRIMER_APELLIDO,
PER_SEGUNDO_APELLIDO,
PER_PRIMER_NOMBRE,
PER_SEGUNDO_NOMBRE) 
VALUES 
(4,
3,
'109990520',
'Barquero',
'Sanchez',
'Diego',
'Armando'
);

INSERT INTO LABORATORIO_PERSONA(PER_ID,
PER_TGE_ID,
PER_IDENTIFICACION,
PER_PRIMER_APELLIDO,
PER_SEGUNDO_APELLIDO,
PER_PRIMER_NOMBRE,
PER_SEGUNDO_NOMBRE) 
VALUES 
(5,
3,
'201587465',
'Salazar',
'Arrieta',
'Oscar',
'Fabricio'
);

INSERT INTO LABORATORIO_PERSONA(PER_ID,
PER_TGE_ID,
PER_IDENTIFICACION,
PER_PRIMER_APELLIDO,
PER_SEGUNDO_APELLIDO,
PER_PRIMER_NOMBRE,
PER_SEGUNDO_NOMBRE) 
VALUES 
(6,
2,
'506990999',
'Ugalde',
'Gonzalez',
'Maria',
'Elizabeth'
);

INSERT INTO LABORATORIO_VENDEDOR(VND_ID,
VND_PER_ID,
VND_PORC_COMISION) 
VALUES 
(1,
4,
10
);

INSERT INTO LABORATORIO_VENDEDOR(VND_ID,
VND_PER_ID,
VND_PORC_COMISION) 
VALUES 
(2,
2,
20
);

INSERT INTO LABORATORIO_CLIENTE(CTE_ID,
CTE_PER_ID,
CTE_LIMITE_CREDITO) 
VALUES 
(1,
6,
25000
);

INSERT INTO LABORATORIO_CLIENTE(CTE_ID,
CTE_PER_ID,
CTE_LIMITE_CREDITO) 
VALUES 
(2,
3,
55000
);

INSERT INTO LABORATORIO_COLOR(CLR_ID,
CLR_DESCRIPCION) 
VALUES 
(1,
'Rojo'
);

INSERT INTO LABORATORIO_COLOR(CLR_ID,
CLR_DESCRIPCION) 
VALUES 
(2,
'Azul'
);

INSERT INTO LABORATORIO_COLOR(CLR_ID,
CLR_DESCRIPCION) 
VALUES 
(3,
'Negro'
);

INSERT INTO LABORATORIO_MARCA(MRC_ID,
MRC_DESCRIPCION) 
VALUES 
(1,
'Cube'
);

INSERT INTO LABORATORIO_MARCA(MRC_ID,
MRC_DESCRIPCION) 
VALUES 
(2,
'Scott'
);

INSERT INTO LABORATORIO_MARCA(MRC_ID,
MRC_DESCRIPCION) 
VALUES 
(3,
'Giant'
);

INSERT INTO LABORATORIO_TAMANO(TMN_ID,
TMN_DESCRIPCION) 
VALUES 
(1,
'S'
);

INSERT INTO LABORATORIO_TAMANO(TMN_ID,
TMN_DESCRIPCION) 
VALUES 
(2,
'M'
);

INSERT INTO LABORATORIO_TAMANO(TMN_ID,
TMN_DESCRIPCION) 
VALUES 
(3,
'L'
);

INSERT INTO LABORATORIO_TIPO_BICICLETA(TBC_ID,
TBC_DESCRIPCION) 
VALUES 
(1,
'Urbanas'
);

INSERT INTO LABORATORIO_TIPO_BICICLETA(TBC_ID,
TBC_DESCRIPCION) 
VALUES 
(2,
'Ruta'
);

INSERT INTO LABORATORIO_TIPO_BICICLETA(TBC_ID,
TBC_DESCRIPCION) 
VALUES 
(3,
'Triatlon'
);

INSERT INTO LABORATORIO_INVENTARIO(INV_ID,
INV_TBC_ID,
INV_MRC_ID,
INV_CLR_ID,
INV_TMN_ID,
INV_NUMERO_SERIO,
INV_MODELO,
INV_FECHA,
INV_PRECIO_VENTA)
VALUES
(1,
2,
3,
1,
2,
12312,
'Nueva Entrada',
SYSDATE,
5000
);

INSERT INTO LABORATORIO_INVENTARIO(INV_ID,
INV_TBC_ID,
INV_MRC_ID,
INV_CLR_ID,
INV_TMN_ID,
INV_NUMERO_SERIO,
INV_MODELO,
INV_FECHA,
INV_PRECIO_VENTA)
VALUES
(2,
1,
1,
2,
3,
21123,
'Modelo 2021',
SYSDATE,
8000
);

INSERT INTO LABORATORIO_INVENTARIO(INV_ID,
INV_TBC_ID,
INV_MRC_ID,
INV_CLR_ID,
INV_TMN_ID,
INV_NUMERO_SERIO,
INV_MODELO,
INV_FECHA,
INV_PRECIO_VENTA)
VALUES
(3,
3,
1,
2,
2,
33122,
'Modelo 2023',
SYSDATE,
7800
);

INSERT INTO LABORATORIO_INVENTARIO(INV_ID,
INV_TBC_ID,
INV_MRC_ID,
INV_CLR_ID,
INV_TMN_ID,
INV_NUMERO_SERIO,
INV_MODELO,
INV_FECHA,
INV_PRECIO_VENTA)
VALUES
(4,
3,
2,
1,
2,
33122,
'Modelo 2022',
SYSDATE,
8500
);

INSERT INTO LABORATORIO_INVENTARIO(INV_ID,
INV_TBC_ID,
INV_MRC_ID,
INV_CLR_ID,
INV_TMN_ID,
INV_NUMERO_SERIO,
INV_MODELO,
INV_FECHA,
INV_PRECIO_VENTA)
VALUES
(5,
2,
1,
3,
2,
52132,
'Modelo 2019',
SYSDATE,
6000
);

INSERT INTO LABORATORIO_INVENTARIO(INV_ID,
INV_TBC_ID,
INV_MRC_ID,
INV_CLR_ID,
INV_TMN_ID,
INV_NUMERO_SERIO,
INV_MODELO,
INV_FECHA,
INV_PRECIO_VENTA)
VALUES
(6,
1,
3,
3,
2,
61332,
'Nueva Entrada',
SYSDATE,
12000
);

INSERT INTO LABORATORIO_INVENTARIO(INV_ID,
INV_TBC_ID,
INV_MRC_ID,
INV_CLR_ID,
INV_TMN_ID,
INV_NUMERO_SERIO,
INV_MODELO,
INV_FECHA,
INV_PRECIO_VENTA)
VALUES
(7,
1,
1,
2,
2,
71122,
'Nueva Entrada',
SYSDATE,
15000
);

INSERT INTO LABORATORIO_INVENTARIO(INV_ID,
INV_TBC_ID,
INV_MRC_ID,
INV_CLR_ID,
INV_TMN_ID,
INV_NUMERO_SERIO,
INV_MODELO,
INV_FECHA,
INV_PRECIO_VENTA)
VALUES
(8,
2,
1,
1,
3,
82113,
'Liquidacion',
SYSDATE,
4500
);

INSERT INTO LABORATORIO_INVENTARIO(INV_ID,
INV_TBC_ID,
INV_MRC_ID,
INV_CLR_ID,
INV_TMN_ID,
INV_NUMERO_SERIO,
INV_MODELO,
INV_FECHA,
INV_PRECIO_VENTA)
VALUES
(9,
3,
2,
1,
2,
93212,
'Liquidacion',
SYSDATE,
4250
);

SELECT * FROM LABORATORIO_INVENTARIO

INSERT INTO LABORATORIO_VENTA(VNT_ID,
VNT_VND_ID,
VNT_CTE_ID,
VNT_INV_ID,
VNT_FECHA,
VNT_PRECIO_COSTO,
VNT_DESCUENTO)
VALUES
(1,
1,
1,
7,
SYSDATE,
15000,
1000);

SELECT * FROM LABORATORIO_INVENTARIO

INSERT INTO LABORATORIO_VENTA(VNT_ID,
VNT_VND_ID,
VNT_CTE_ID,
VNT_INV_ID,
VNT_FECHA,
VNT_PRECIO_COSTO,
VNT_DESCUENTO)
VALUES
(5,
1,
1,
7,
TO_DATE('08-10-2023','MM-DD-YYYY'),
30000,
1000);

INSERT INTO LABORATORIO_VENTA(VNT_ID,
VNT_VND_ID,
VNT_CTE_ID,
VNT_INV_ID,
VNT_FECHA,
VNT_PRECIO_COSTO,
VNT_DESCUENTO)
VALUES
(2,
1,
2,
9,
SYSDATE,
4250,
250);

INSERT INTO LABORATORIO_VENTA(VNT_ID,
VNT_VND_ID,
VNT_CTE_ID,
VNT_INV_ID,
VNT_FECHA,
VNT_PRECIO_COSTO,
VNT_DESCUENTO)
VALUES
(3,
2,
2,
1,
SYSDATE,
5000,
200);

INSERT INTO LABORATORIO_VENTA(VNT_ID,
VNT_VND_ID,
VNT_CTE_ID,
VNT_INV_ID,
VNT_FECHA,
VNT_PRECIO_COSTO,
VNT_DESCUENTO)
VALUES
(4,
2,
2,
2,
SYSDATE,
8000,
400);

SELECT * FROM LABORATORIO_PERSONA;

SELECT * FROM LABORATORIO_PERSONA WHERE PER_ID = 2;

SELECT *
    FROM laboratorio_persona A
    INNER JOIN laboratorio_genero B
    ON A.PER_TGE_ID = B.TGE_ID;
    
SELECT *
    FROM laboratorio_persona A
    INNER JOIN laboratorio_genero B
    ON A.PER_TGE_ID = B.TGE_ID
    WHERE A.PER_ID = 2;
    
SELECT * FROM LABORATORIO_CLIENTE;
    
SELECT *
    FROM LABORATORIO_CLIENTE A
    INNER JOIN LABORATORIO_PERSONA B ON A.CTE_PER_ID = B.PER_ID
    INNER JOIN LABORATORIO_GENERO C ON B.PER_TGE_ID = C.TGE_ID
    
SELECT *
    FROM LABORATORIO_CLIENTE A
    INNER JOIN LABORATORIO_PERSONA B ON A.CTE_PER_ID = B.PER_ID
    INNER JOIN LABORATORIO_GENERO C ON B.PER_TGE_ID = C.TGE_ID
    WHERE A.CTE_ID = 1;
    
-- MOSTRAR CÓDIGO DE CLIENTE, LIMITE DE CRÉDITO, CÓDIGO DE PERSONA, IDENTIFICACION, NOMBRE COMPLETO Y DESCRIPCION DEL GÉNERO.

SELECT A.CTE_ID CODIGO_CLIENTE,
       A.CTE_LIMITE_CREDITO LIMITE_CREDITO,
       B.PER_ID CODIGO_PERSONA,
       B.PER_IDENTIFICACION IDENTIFICACION,
       B.PER_PRIMER_APELLIDO PRIMER_APELLIDO,
       B.PER_SEGUNDO_APELLIDO SEGUNDO_APELLIDO,
       B.PER_PRIMER_NOMBRE PRIMER_NOMBRE,
       B.PER_SEGUNDO_NOMBRE SEGUNDO_NOMBRE,
       C.TGE_DESCRIPCION GENERO
    FROM LABORATORIO_CLIENTE A
    INNER JOIN LABORATORIO_PERSONA B ON A.CTE_PER_ID = B.PER_ID
    INNER JOIN LABORATORIO_GENERO C ON B.PER_TGE_ID = C.TGE_ID;
    
-- MOSTRAR INFORMACIÓN COMPLETA DE LA TABLA DE CLIENTES, CÓDIGO DE PERSONA, IDENTIFICACION, NOMBRE COMPLETO Y TODA LA INFORMACIÓN DE LA TABLA DE GÉNERO.

SELECT A.*,
       B.PER_ID CODIGO_PERSONA,
       B.PER_IDENTIFICACION IDENTIFICACION,
       B.PER_PRIMER_APELLIDO PRIMER_APELLIDO,
       B.PER_SEGUNDO_APELLIDO SEGUNDO_APELLIDO,
       B.PER_PRIMER_NOMBRE PRIMER_NOMBRE,
       B.PER_SEGUNDO_NOMBRE SEGUNDO_NOMBRE,
       C.*
    FROM LABORATORIO_CLIENTE A
    INNER JOIN LABORATORIO_PERSONA B ON A.CTE_PER_ID = B.PER_ID
    INNER JOIN LABORATORIO_GENERO C ON B.PER_TGE_ID = C.TGE_ID;
    
---------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #01,
---------------------------------------------------------------------------------

SELECT VTA.*,
       VND.VND_ID VENDEDOR,
       VND.VND_PORC_COMISION COMISION_VENDEDOR,
       CTE.CTE_ID CLIENTE,
       CTE.CTE_LIMITE_CREDITO LIMITE_CREDITO,
       TBC.TBC_DESCRIPCION BICICLETA
    FROM LABORATORIO_VENTA VTA 
    INNER JOIN LABORATORIO_VENDEDOR VND ON VND.VND_ID = VTA.VNT_VND_ID
    INNER JOIN LABORATORIO_CLIENTE CTE ON CTE.CTE_ID = VTA.VNT_CTE_ID
    INNER JOIN LABORATORIO_INVENTARIO INV ON INV.INV_ID = VTA.VNT_INV_ID
    INNER JOIN LABORATORIO_TIPO_BICICLETA TBC ON TBC.TBC_ID = INV.INV_TBC_ID
;

---------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #01, Adicionalmente traer nobre vendedor y cliente.
---------------------------------------------------------------------------------

SELECT VTA.*,
       VND.VND_ID VENDEDOR,
       VND.VND_PORC_COMISION COMISION_VENDEDOR,
       PRV.PER_IDENTIFICACION VEND_IDENTIFICACION,
       PRV.PER_PRIMER_APELLIDO VEND_APELLIDO1,
       PRV.PER_SEGUNDO_APELLIDO VEND_APELLIDO2,
       PRV.PER_PRIMER_NOMBRE VEND_NOMBRE1,
       PRV.PER_SEGUNDO_NOMBRE VEND_NOMBRE2,
       CTE.CTE_ID CLIENTE,
       PRC.PER_IDENTIFICACION CLIENTE_IDENTIFICACION,
       PRC.PER_PRIMER_APELLIDO CLIENTE_APELLIDO1,
       PRC.PER_SEGUNDO_APELLIDO CLIENTE_APELLIDO2,
       PRC.PER_PRIMER_NOMBRE CLIENTE_NOMBRE1,
       PRC.PER_SEGUNDO_NOMBRE CLIENTE_NOMBRE2,
       CTE.CTE_LIMITE_CREDITO LIMITE_CREDITO,
       TBC.TBC_DESCRIPCION BICICLETA
    FROM LABORATORIO_VENTA VTA 
    INNER JOIN LABORATORIO_VENDEDOR VND ON VND.VND_ID = VTA.VNT_VND_ID
    INNER JOIN LABORATORIO_CLIENTE CTE ON CTE.CTE_ID = VTA.VNT_CTE_ID
    INNER JOIN LABORATORIO_INVENTARIO INV ON INV.INV_ID = VTA.VNT_INV_ID
    INNER JOIN LABORATORIO_TIPO_BICICLETA TBC ON TBC.TBC_ID = INV.INV_TBC_ID
    INNER JOIN LABORATORIO_PERSONA PRV ON VND.VND_PER_ID = PRV.PER_ID
    INNER JOIN LABORATORIO_PERSONA PRC ON CTE.CTE_PER_ID = PRC.PER_ID
;

---------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #02
---------------------------------------------------------------------------------

SELECT INV.*,
       TBC.TBC_DESCRIPCION TIPO_BICICLETA,
       MRC.MRC_DESCRIPCION MARCA_BICICLETA,
       CLR.CLR_DESCRIPCION COLOR_BICICLETA
    FROM LABORATORIO_INVENTARIO INV
    LEFT OUTER JOIN LABORATORIO_TIPO_BICICLETA TBC ON TBC.TBC_ID = INV.INV_TBC_ID
    LEFT OUTER JOIN LABORATORIO_MARCA MRC ON MRC.MRC_ID = INV.INV_MRC_ID
    LEFT OUTER JOIN LABORATORIO_COLOR CLR ON CLR.CLR_ID = INV.INV_CLR_ID
;

---------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #03
---------------------------------------------------------------------------------

SELECT VNT.VNT_ID,
       CTE.CTE_ID ID_CLIENTE,
       PRC.PER_IDENTIFICACION CLIENTE_IDENTIFICACION,
       PRC.PER_PRIMER_APELLIDO CLIENTE_APELLIDO1,
       PRC.PER_SEGUNDO_APELLIDO CLIENTE_APELLIDO2,
       PRC.PER_PRIMER_NOMBRE CLIENTE_NOMBRE1,
       PRC.PER_SEGUNDO_NOMBRE CLIENTE_NOMBRE2
    FROM LABORATORIO_VENTA VNT
    RIGHT OUTER JOIN LABORATORIO_CLIENTE CTE ON CTE.CTE_ID = VNT.VNT_CTE_ID
    INNER JOIN LABORATORIO_PERSONA PRC ON CTE.CTE_PER_ID = PRC.PER_ID
;

---------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #04
---------------------------------------------------------------------------------

SELECT VNT.VNT_ID ID_VENTA,
       INV.INV_ID ID_BICICLETA,
       INV.INV_NUMERO_SERIO NUMERO_SERIE,
       INV.INV_MODELO MODELO,
       INV.INV_FECHA FECHA_INVENTARIO,
       INV.INV_PRECIO_VENTA PRECIO,
       TBC.TBC_DESCRIPCION TIPO_BICICLETA,
       MRC.MRC_DESCRIPCION MARCA_BICICLETA,
       CLR.CLR_DESCRIPCION COLOR_BICICLETA
    FROM LABORATORIO_VENTA VNT
    INNER JOIN LABORATORIO_INVENTARIO INV ON INV.INV_ID = VNT.VNT_INV_ID
    INNER JOIN LABORATORIO_TIPO_BICICLETA TBC ON TBC.TBC_ID = INV.INV_TBC_ID
    INNER JOIN LABORATORIO_MARCA MRC ON MRC.MRC_ID = INV.INV_MRC_ID
    INNER JOIN LABORATORIO_COLOR CLR ON CLR.CLR_ID = INV.INV_CLR_ID
;

---------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #05
---------------------------------------------------------------------------------

SELECT VNT.VNT_ID,
       PRC.PER_IDENTIFICACION CLIENTE_IDENTIFICACION,
       PRC.PER_PRIMER_APELLIDO CLIENTE_APELLIDO1,
       PRC.PER_SEGUNDO_APELLIDO CLIENTE_APELLIDO2,
       PRC.PER_PRIMER_NOMBRE CLIENTE_NOMBRE1,
       PRC.PER_SEGUNDO_NOMBRE CLIENTE_NOMBRE2,
       TGE.TGE_DESCRIPCION GENERO_CLIENTE
    FROM LABORATORIO_VENTA VNT
    LEFT OUTER JOIN LABORATORIO_CLIENTE CTE ON CTE.CTE_ID = VNT.VNT_CTE_ID
    INNER JOIN LABORATORIO_PERSONA PRC ON CTE.CTE_PER_ID = PRC.PER_ID
    RIGHT OUTER JOIN LABORATORIO_GENERO TGE ON PRC.PER_TGE_ID = TGE.TGE_ID
;

---------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #06
---------------------------------------------------------------------------------

SELECT VNT.VNT_ID,
       VND.VND_ID,
       VND.VND_PORC_COMISION COMISION_VENDEDOR,
       PRV.PER_IDENTIFICACION,
       PRV.PER_PRIMER_APELLIDO VEND_APELLIDO1,
       PRV.PER_SEGUNDO_APELLIDO VEND_APELLIDO2,
       PRV.PER_PRIMER_NOMBRE VEND_NOMBRE1,
       PRV.PER_SEGUNDO_NOMBRE VEND_NOMBRE2,
       CTE.CTE_ID CLIENTE
    FROM LABORATORIO_VENTA VNT
    RIGHT OUTER JOIN LABORATORIO_VENDEDOR VND ON VND.VND_ID = VNT.VNT_VND_ID
    INNER JOIN LABORATORIO_PERSONA PRV ON VND.VND_PER_ID = PRV.PER_ID
    INNER JOIN LABORATORIO_CLIENTE CTE ON CTE.CTE_ID = VNT.VNT_CTE_ID
;

---------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #07
---------------------------------------------------------------------------------

SELECT VNT.VNT_ID ID_VENTA,
       INV.INV_ID ID_BICICLETA,
       INV.INV_NUMERO_SERIO NUMERO_SERIE,
       INV.INV_MODELO MODELO,
       INV.INV_FECHA FECHA_INVENTARIO,
       INV.INV_PRECIO_VENTA PRECIO,
       TBC.TBC_DESCRIPCION TIPO_BICICLETA,
       MRC.MRC_DESCRIPCION MARCA_BICICLETA,
       CLR.CLR_DESCRIPCION COLOR_BICICLETA
    FROM LABORATORIO_VENTA VNT
    LEFT OUTER JOIN LABORATORIO_INVENTARIO INV ON INV.INV_ID = VNT.VNT_INV_ID
    INNER JOIN LABORATORIO_TIPO_BICICLETA TBC ON TBC.TBC_ID = INV.INV_TBC_ID
    INNER JOIN LABORATORIO_MARCA MRC ON MRC.MRC_ID = INV.INV_MRC_ID
    INNER JOIN LABORATORIO_COLOR CLR ON CLR.CLR_ID = INV.INV_CLR_ID
    INNER JOIN LABORATORIO_TAMANO TMN ON TMN.TMN_ID = INV.INV_TMN_ID
    WHERE VNT.VNT_INV_ID IS NULL
;

---------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #08
---------------------------------------------------------------------------------

SELECT VNT.VNT_ID ID_VENTA,
       VNT.VNT_FECHA,
       VNT.VNT_PRECIO_COSTO,
       VNT.VNT_DESCUENTO,
       INV.INV_ID ID_BICICLETA,
       INV.INV_NUMERO_SERIO,
       INV.INV_MODELO MODELO,
       INV.INV_FECHA FECHA_INVENTARIO,
       INV.INV_PRECIO_VENTA PRECIO,
       TBC.TBC_DESCRIPCION TIPO_BICICLETA,
       MRC.MRC_DESCRIPCION MARCA_BICICLETA,
       CLR.CLR_DESCRIPCION COLOR_BICICLETA,
       CTE.CTE_ID ID_CLIENTE,
       PRC.PER_IDENTIFICACION CLIENTE_IDENTIFICACION,
       PRC.PER_PRIMER_APELLIDO CLIENTE_APELLIDO1,
       PRC.PER_PRIMER_NOMBRE CLIENTE_NOMBRE1
    FROM LABORATORIO_VENTA VNT
    FULL OUTER JOIN LABORATORIO_INVENTARIO INV ON INV.INV_ID = VNT.VNT_INV_ID 
    FULL OUTER JOIN LABORATORIO_TIPO_BICICLETA TBC ON TBC.TBC_ID = INV.INV_TBC_ID
    FULL OUTER JOIN LABORATORIO_MARCA MRC ON MRC.MRC_ID = INV.INV_MRC_ID
    FULL OUTER JOIN LABORATORIO_COLOR CLR ON CLR.CLR_ID = INV.INV_CLR_ID
    FULL OUTER JOIN LABORATORIO_CLIENTE CTE ON CTE.CTE_ID = VNT.VNT_CTE_ID
    FULL OUTER JOIN LABORATORIO_PERSONA PRC ON CTE.CTE_PER_ID = PRC.PER_ID
;

---------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #09
---------------------------------------------------------------------------------

SELECT VNT.VNT_ID ID_VENTA,
       VNT.VNT_FECHA,
       VND.VND_ID,
       VND.VND_PORC_COMISION COMISION_VENDEDOR,
       PRV.PER_IDENTIFICACION,
       PRV.PER_PRIMER_APELLIDO VEND_APELLIDO1,
       PRV.PER_SEGUNDO_APELLIDO VEND_APELLIDO2,
       PRV.PER_PRIMER_NOMBRE VEND_NOMBRE1,
       PRV.PER_SEGUNDO_NOMBRE VEND_NOMBRE2,
       CTE.CTE_ID CLIENTE,
       CTE.CTE_LIMITE_CREDITO,
       PRC.PER_IDENTIFICACION CLIENTE_IDENTIFICACION,
       PRC.PER_PRIMER_APELLIDO CLIENTE_APELLIDO1,
       PRC.PER_PRIMER_NOMBRE CLIENTE_NOMBRE1,
       INV_NUMERO_SERIO NUMSERIE_BICICLETA,
       INV_MODELO MODELO_BICICLETA
    FROM LABORATORIO_VENTA VNT
    INNER JOIN LABORATORIO_VENDEDOR VND ON VND.VND_ID = VNT.VNT_VND_ID
    INNER JOIN LABORATORIO_PERSONA PRV ON VND.VND_PER_ID = PRV.PER_ID
    INNER JOIN LABORATORIO_CLIENTE CTE ON CTE.CTE_ID = VNT.VNT_CTE_ID
    INNER JOIN LABORATORIO_PERSONA PRC ON CTE.CTE_PER_ID = PRC.PER_ID
    INNER JOIN LABORATORIO_INVENTARIO INV ON INV.INV_ID = VNT.VNT_INV_ID
 ;
 
 --------------------------------------------------------------------------------
-- CASO DE PRÁCTICA #10
---------------------------------------------------------------------------------

SELECT VNT.VNT_ID ID_VENTA,
       VND.VND_ID,
       PRV.PER_IDENTIFICACION,
       PRV.PER_PRIMER_APELLIDO VEND_APELLIDO1,
       PRV.PER_SEGUNDO_APELLIDO VEND_APELLIDO2,
       PRV.PER_PRIMER_NOMBRE VEND_NOMBRE1,
       PRV.PER_SEGUNDO_NOMBRE VEND_NOMBRE2,
       CTE.CTE_ID CLIENTE,
       PRC.PER_IDENTIFICACION CLIENTE_IDENTIFICACION,
       PRC.PER_PRIMER_APELLIDO CLIENTE_APELLIDO1,
       PRC.PER_SEGUNDO_APELLIDO CLIENTE_APELLIDO2,
       PRC.PER_PRIMER_NOMBRE CLIENTE_NOMBRE1,
       PRC.PER_SEGUNDO_NOMBRE CLIENTE_NOMBRE2
    FROM LABORATORIO_VENTA VNT
    RIGHT OUTER JOIN LABORATORIO_VENDEDOR VND ON VND.VND_ID = VNT.VNT_VND_ID
    INNER JOIN LABORATORIO_PERSONA PRV ON VND.VND_PER_ID = PRV.PER_ID
    LEFT OUTER JOIN LABORATORIO_CLIENTE CTE ON CTE.CTE_ID = VNT.VNT_CTE_ID
    INNER JOIN LABORATORIO_PERSONA PRC ON CTE.CTE_PER_ID = PRC.PER_ID
;